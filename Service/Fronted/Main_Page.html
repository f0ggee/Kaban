<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Filesb — File Upload</title>

  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 connect-src 'self';
                 img-src 'self' data:;
                 style-src 'self' https://fonts.googleapis.com 'unsafe-inline';
                 font-src https://fonts.gstatic.com;
                 script-src 'self' 'unsafe-inline';
                 base-uri 'self';
                 form-action 'self'">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0a0a0a; --panel:#000; --text:#e5fff4; --muted:#89f0c2; --border:#0f3a2e;
      --primary:#10b981; --primary-press:#059669; --focus:#22c55e; --danger:#dc2626;
    }
    *,*::before,*::after{ box-sizing:border-box; }
    html,body{ height:100%; background:var(--bg); color:var(--text); font-family:"Inter",system-ui; }
    a{ color:var(--muted); text-decoration:none; }
    a:hover{ color:var(--text); }

    .container{ max-width:980px; margin:0 auto; padding:24px 16px 64px; }

    .header{ display:flex; align-items:center; justify-content:space-between; margin-bottom:24px; }
    .brand{ font-weight:700; color:var(--primary); font-size:20px; letter-spacing:.4px; }
    .auth{ display:flex; gap:12px; }

    /* ===== BUTTON ANIMATIONS ===== */
    .btn-outline, .btn-primary{
      transition:background .15s ease, border-color .15s ease, transform .08s ease;
    }
    .btn-primary:hover{ background:var(--primary-press); }
    .btn-outline:hover{ border-color:var(--focus); }
    .btn-primary:active, .btn-outline:active{ transform:translateY(1px); }

    .btn-outline{
      padding:10px 14px; border:1px solid var(--border); border-radius:10px;
      background:#07110e; color:var(--text); font-weight:600; font-size:14px;
    }

    .btn-primary{
      padding:14px 18px; border:none; border-radius:12px; font-weight:700;
      background:var(--primary); color:#00150e; cursor:pointer; font-size:16px;
    }

    .grid{ display:grid; grid-template-columns: 1.1fr 0.9fr; gap:24px; }
    @media (max-width:860px){ .grid{ grid-template-columns:1fr; } }

    .card{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:16px; padding:24px;
      box-shadow:0 0 28px rgba(16,185,129,.12);
    }
    .title{ color:var(--primary); margin:0 0 8px; font-size:26px; font-weight:700; }
    .sub{ color:var(--muted); margin:0 0 18px; }

    .dropzone{
      border:2px dashed #145a42;
      border-radius:14px; padding:26px; text-align:center; background:#06130f;
      transition:border-color .15s ease, background .15s ease;
    }

    .file-list{ margin-top:18px; display:grid; gap:10px; }

    .overlay{ position:fixed; inset:0; background:rgba(0,0,0,.72); display:none; align-items:center; justify-content:center; z-index:9999; pointer-events:none; }
    .overlay.show{ display:flex; }

    @media (max-width:1024px){
      .container{ padding:20px 12px; }
      .title{ font-size:22px; }
    }
    @media (max-width:768px){
      .header{ flex-direction:column; gap:12px; }
      .grid{ grid-template-columns:1fr; }
    }
    @media (max-width:480px){
      .title{ font-size:20px; }
      .btn-primary, .btn-outline{ width:100%; }
      .dropzone{ padding:20px; }
    }

  </style>
</head>

<body>
<div class="container">

  <header class="header">
    <div class="brand">Filesb</div>
    <nav class="auth">
      <a class="btn-outline" href="/profile">Profile</a>
    </nav>
  </header>

  <main class="grid">

    <section class="card">
      <h1 class="title">File Upload</h1>
      <p class="sub">Choose files and get an instant share link</p>

      <div id="dropzone" class="dropzone">
        Drag & Drop files here
        <div style="margin-top:12px;">
          <button id="chooseBtn" class="btn-primary" type="button">Choose files</button>
          <button id="uploadBtn" class="btn-outline" type="button" disabled>Upload</button>
        </div>
        <div class="sub" style="font-size:13px;">Multiple selection supported</div>
        <div style="color:#dc2626;font-size:14px;">Max file size: 2 GB</div>
        <input id="fileInput" type="file" multiple hidden />
      </div>

      <div id="fileList" class="file-list"></div>
      <div id="message" class="message"></div>
    </section>

    <aside class="card">
      <h2 class="title">Why Filesb</h2>
      <ul class="sub" style="margin-left:18px;">
        <li>No messengers needed</li>
        <li>Minimalistic interface</li>
        <li>Instant file links</li>
        <li>Dark theme with green accents</li>
      </ul>

      <hr style="border-color:#0f3a2e;margin:18px 0;">

      <h2 class="title">Advanced Protection</h2>
      <ul class="sub" style="margin-left:18px;">
        <li>Modern file encryption</li>
        <li>Short server storage time</li>
        <li>Auto-delete after first download</li>
      </ul>

      <a href="/protect" class="btn-primary" style="display:block;text-align:center;margin-top:18px;">
        Go to protection
      </a>

      <div style="margin-top:28px;text-align:center;font-size:12px;opacity:.7;">
        © 2025 Filesb
      </div>
    </aside>

  </main>
</div>

<div id="overlay" class="overlay">
  <div class="card">
    <h1 class="title">Filesb — uploading</h1>
    <p class="sub">Please wait…</p>
  </div>
</div>

<script>
  const dropzone = document.getElementById('dropzone');
  const chooseBtn = document.getElementById('chooseBtn');
  const uploadBtn = document.getElementById('uploadBtn');
  const fileInput = document.getElementById('fileInput');
  const list = document.getElementById('fileList');
  const message = document.getElementById('message');
  const overlay = document.getElementById('overlay');

  const MAX_SIZE = 5 * 1024 * 1024 * 1024;

  let files = [];

  function showMessage(text){
    message.textContent = text;
    message.style.display = 'block';
  }

  function renderList(){
    list.innerHTML = '';
    files.forEach(f => {
      const row = document.createElement('div');
      row.style.padding='10px';
      row.style.border='1px solid var(--border)';
      row.style.borderRadius='10px';
      row.textContent = f.name;
      list.appendChild(row);
    });
    uploadBtn.disabled = files.length === 0;
  }

  chooseBtn.onclick = ()=> fileInput.click();
  fileInput.onchange = e=>{
    files = [...e.target.files];
    renderList();
  };

  uploadBtn.onclick = async ()=>{
    if(files.length===0) return;

    overlay.classList.add('show');

    const fd = new FormData();
    files.forEach(f=>fd.append('file',f));

    const popup = window.open('', '_blank');

    try{
      const res = await fetch('/downloader/api',{method:'POST',body:fd});
      if(res.redirected){
        popup.location = res.url;
      } else {
        popup.document.write(await res.text());
      }
      showMessage("Files uploaded");
    } catch(err){
      showMessage("Error: "+err.message);
      popup.close();
    } finally {
      overlay.classList.remove('show');
    }
  };

  ['dragenter','dragover'].forEach(ev=>
          dropzone.addEventListener(ev,e=>{
            e.preventDefault(); dropzone.style.borderColor="#22c55e";
          })
  );
  ['dragleave','drop'].forEach(ev=>
          dropzone.addEventListener(ev,e=>{
            e.preventDefault(); dropzone.style.borderColor="#145a42";
          })
  );

  dropzone.addEventListener('drop', e=>{
    files = [...e.dataTransfer.files];
    renderList();
  });

</script>

</body>
</html>