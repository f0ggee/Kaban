<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="icon" type="image/png" href="/Fronted/favicon.png">
  <title>Filesb ‚Äî File Upload</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0a0a0a; --panel:#000; --text:#e5fff4; --muted:#89f0c2; --border:#0f3a2e;
      --primary:#10b981; --primary-press:#059669; --focus:#22c55e; --danger:#dc2626;
      --error-bg: rgba(220, 38, 38, 0.15); --error-border: #7f1d1d;
    }
    *,*::before,*::after{ box-sizing:border-box; }
    html,body{ height:100%; background:var(--bg); color:var(--text); font-family:"Inter",system-ui; margin: 0; }

    .container{
      max-width:980px; margin:0 auto;
      padding:clamp(16px, 4vw, 32px) clamp(12px, 3vw, 24px) 64px;
    }

    /* HEADER & NAV */
    .header{
      display:flex; align-items:center; justify-content:space-between;
      margin-bottom:clamp(20px, 5vh, 32px); gap: 12px; flex-wrap: wrap;
    }
    .brand{ font-weight:700; color:var(--primary); font-size:clamp(18px, 4vw, 22px); letter-spacing:.4px; margin-right: auto; }
    .nav-actions { display: flex; gap: 10px; }
    .dropdown-container { position: relative; }
    .dropdown-content {
      position: absolute; top: calc(100% + 10px); right: 0;
      width: clamp(240px, 80vw, 280px);
      background: #050505; border: 1px solid var(--border);
      border-radius: 12px; padding: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.8);
      z-index: 1000; opacity: 0; transform: translateY(-10px);
      pointer-events: none; transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .dropdown-content.show { opacity: 1; transform: translateY(0); pointer-events: auto; }

    .lang-item {
      padding: 10px; border-radius: 8px; cursor: pointer; transition: 0.2s;
      display: flex; justify-content: space-between; font-size: 14px;
    }
    .lang-item:hover { background: #0d261f; color: var(--primary); }
    .lang-item.active { color: var(--primary); font-weight: 700; background: #07110e; }

    .contact-item {
      display: flex; justify-content: space-between; align-items: center;
      background: #0a1a15; padding: 10px 12px; border-radius: 8px;
      margin-bottom: 8px; border: 1px solid transparent; cursor: pointer; transition: 0.2s;
    }
    .contact-item:hover { border-color: var(--primary); background: #0d261f; }
    .contact-label { font-size: 10px; color: var(--muted); text-transform: uppercase; }
    .contact-value { font-weight: 600; font-size: 12px; color: var(--text); }
    .copy-status { font-size: 10px; color: var(--primary); font-weight: 700; }

    /* --- BUTTONS --- */
    .btn-outline, .btn-primary{
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); /* –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è */
      cursor: pointer; white-space: nowrap;
    }

    .btn-outline{
      padding: clamp(8px, 2vw, 10px) clamp(10px, 3vw, 14px);
      border:1px solid var(--border); border-radius:10px;
      background:#07110e; color:var(--text); font-weight:600; font-size:clamp(12px, 2.5vw, 13px);
    }

    /* –≠—Ñ—Ñ–µ–∫—Ç –Ω–∞–≤–µ–¥–µ–Ω–∏—è –¥–ª—è –∫–Ω–æ–ø–∫–∏ Upload (–∫–æ–≥–¥–∞ –æ–Ω–∞ –Ω–µ disabled) */
    .btn-outline:not(:disabled):hover {
      border-color: var(--primary); /* –ó–µ–ª–µ–Ω–∞—è —Ä–∞–º–∫–∞ */
      background: rgba(16, 185, 129, 0.08); /* –õ–µ–≥–∫–∏–π –∑–µ–ª–µ–Ω—ã–π —Ñ–æ–Ω */
      box-shadow: 0 0 12px rgba(16, 185, 129, 0.25); /* –°–≤–µ—á–µ–Ω–∏–µ */
      transform: translateY(-2px); /* –ü—Ä–∏–ø–æ–¥–Ω—è—Ç–∏–µ */
      color: #fff;
    }

    .btn-outline:disabled { opacity:0.3; cursor:not-allowed; }

    .btn-primary{
      padding: clamp(12px, 3vw, 16px) clamp(16px, 4vw, 20px);
      border:none; border-radius:12px; font-weight:700;
      background:var(--primary); color:#00150e; font-size:clamp(14px, 3vw, 16px);
    }
    .btn-primary:hover {
      background: var(--primary-press);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
    }

    /* LAYOUT */
    .grid{ display:grid; grid-template-columns: 1.1fr 0.9fr; gap:clamp(16px, 3vw, 24px); }
    .card{
      background:var(--panel); border:1px solid var(--border);
      border-radius:16px; padding:clamp(16px, 4vw, 24px);
      box-shadow:0 0 28px rgba(16,185,129,.12);
    }
    .title{ color:var(--primary); margin:0 0 8px; font-size:clamp(22px, 5vw, 26px); font-weight:700; }
    .sub{ color:var(--muted); margin:0 0 18px; font-size:clamp(13px, 3vw, 15px); }

    /* DROPZONE & FILES */
    .dropzone{
      border:2px dashed #145a42; border-radius:14px; padding:clamp(20px, 5vw, 32px);
      text-align:center; background:#06130f; transition: all 0.2s;
    }
    .dropzone.dragover { border-color:var(--focus); background:#072015; }

    /* –û–®–ò–ë–ö–ò */
    .error-box {
      margin-top: 20px; padding: 16px;
      background: var(--error-bg); border: 1px solid var(--error-border);
      border-radius: 12px; color: #ff8a8a;
      display: none; align-items: flex-start; gap: 12px;
      animation: fadeIn 0.3s ease-out;
    }
    .error-box.visible { display: flex; }
    .error-icon { flex-shrink: 0; width: 20px; height: 20px; fill: currentColor; margin-top: 2px; }
    .error-content { flex: 1; }
    .error-title { font-weight: 700; color: #ffcccc; font-size: 14px; margin-bottom: 4px; display: block; }
    .error-msg { font-size: 14px; line-height: 1.4; }
    .error-close {
      background: none; border: none; color: #ff8a8a; cursor: pointer;
      font-size: 18px; padding: 0; line-height: 1; opacity: 0.7;
    }
    .error-close:hover { opacity: 1; color: #fff; }

    /* OVERLAY */
    .overlay{
      position:fixed; inset:0; background:rgba(0,0,0,.85);
      display:none; align-items:center; justify-content:center;
      z-index:9999; backdrop-filter: blur(4px);
    }
    .overlay.show{ display:flex; }
    .terminal-loader {
      border: 0.1em solid #333; background-color: #1a1a1a;
      color: #0f0; font-family: "Courier New", Courier, monospace;
      font-size: 1.1em; padding: 1.5em 1em; width: 14em;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5); border-radius: 8px;
      position: relative; overflow: hidden;
    }
    .terminal-header { position: absolute; top: 0; left: 0; right: 0; height: 1.5em; background-color: #333; padding: 0 0.4em; }
    .terminal-title { float: left; line-height: 1.5em; color: #eee; font-size: 0.8em; }
    .text { display: inline-block; white-space: nowrap; overflow: hidden; border-right: 0.2em solid #0f0; margin-top: 1.5em; width: 0; }
    .anim-type { animation: typeAndHold 3s steps(10) infinite, blink 0.5s step-end infinite alternate; }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes typeAndHold { 0%, 10% { width: 0; } 50%, 90% { width: 10em; } 100% { width: 0; } }

    @media (max-width:860px){ .grid{ grid-template-columns:1fr; } }
    @media (max-width:480px) {
      .nav-actions { width: 100%; justify-content: space-between; margin-top: 10px; }
      .nav-actions .dropdown-container { flex: 1; }
      .btn-outline { width: 100%; text-align: center; }
    }
  </style>
</head>
<body>

<div class="container">
  <header class="header">
    <div class="brand">Filesb</div>
    <div class="nav-actions">
      <div class="dropdown-container">
        <button class="btn-outline" id="langBtn" type="button">Language ‚ñæ</button>
        <div class="dropdown-content" id="langDropdown" style="width: 150px;">
          <div class="lang-item" data-lang="en" onclick="setLanguage('en')">English <span>üá∫üá∏</span></div>
          <div class="lang-item" data-lang="ru" onclick="setLanguage('ru')">–†—É—Å—Å–∫–∏–π <span>üá∑üá∫</span></div>
        </div>
      </div>
      <div class="dropdown-container">
        <button class="btn-outline" id="devContactBtn" type="button" style="border-color: var(--primary); color: var(--primary);">
          Developer Contact ‚ñæ
        </button>
        <div class="dropdown-content" id="devDropdown">
          <div style="margin-bottom: 12px; font-weight: 700; font-size: 14px; color: var(--primary);" data-i18n="contactTitle">Contact Info</div>
          <div class="contact-item" onclick="copyValue('@ishotos', this)">
            <div>
              <div class="contact-label">Telegram</div>
              <div class="contact-value">@ishotos</div>
            </div>
            <div class="copy-status" data-i18n="copy">Copy</div>
          </div>
          <div class="contact-item" onclick="copyValue('foggefogge2000@gmail.com', this)">
            <div>
              <div class="contact-label">Gmail</div>
              <div class="contact-value">foggefogge2000@gmail.com</div>
            </div>
            <div class="copy-status" data-i18n="copy">Copy</div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="grid">
    <section class="card">
      <h1 class="title" data-i18n="uploadTitle">File Upload</h1>
      <p class="sub" data-i18n="uploadSub">Choose files and get an instant share link</p>

      <div class="dropzone" id="dropzone">
        <div style="margin-bottom: 15px;" data-i18n="dropText">Drag & Drop files here</div>
        <div style="display:flex; gap:10px; justify-content:center; flex-wrap:wrap;">
          <button class="btn-primary" id="chooseBtn" type="button" data-i18n="chooseBtn">Choose files</button>
          <button class="btn-outline" id="uploadBtn" type="button" disabled data-i18n="uploadBtn">Upload</button>
        </div>
        <div class="sub" style="font-size:13px; margin-top:12px;" data-i18n="multipleSupport">Multiple selection supported</div>
        <div style="color:var(--danger); font-size:14px;"><span data-i18n="maxSize">Max file size</span>: 1 GB</div>
        <input type="file" id="fileInput" multiple hidden>
      </div>

      <div id="errorBox" class="error-box">
        <svg class="error-icon" viewBox="0 0 24 24">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
        </svg>
        <div class="error-content">
          <span class="error-title" data-i18n="errTitle">Error</span>
          <span id="errorMessage" class="error-msg"></span>
        </div>
        <button class="error-close" onclick="hideError()" type="button">√ó</button>
      </div>

      <div id="fileList" style="margin-top:15px; font-size:14px; color:var(--muted);"></div>
    </section>

    <aside class="card">
      <h2 class="title" data-i18n="whyTitle">Why Filesb</h2>
      <ul class="sub" style="padding-left:18px; line-height:1.6;">
        <li data-i18n="why1">No messengers needed</li>
        <li data-i18n="why2">Minimalistic interface</li>
        <li data-i18n="why3">Instant file links</li>
      </ul>
      <hr style="border:0; border-top:1px solid var(--border); margin:18px 0;">
      <h2 class="title" data-i18n="advTitle">Advanced Protection</h2>
      <ul class="sub" style="padding-left:18px; line-height:1.6; margin-bottom: 16px;">
        <li data-i18n="adv1">Modern file encryption</li>
        <li data-i18n="adv2">Short server storage time</li>
      </ul>
      <button id="protectBtn" class="btn-primary" style="width:100%;" data-i18n="protectBtn">Go to protection</button>
    </aside>
  </main>
</div>

<div id="overlay" class="overlay">
  <div class="terminal-loader">
    <div class="terminal-header">
      <div class="terminal-title" data-i18n="status">Status</div>
    </div>
    <div id="terminalText" class="text anim-type">Loading...</div>
  </div>
</div>

<script>
  // --- –õ–û–ö–ê–õ–ò–ó–ê–¶–ò–Ø –ò –¢–ï–ö–°–¢–´ ---
  const translations = {
    en: {
      langBtn: "Language: EN ‚ñæ", contactBtn: "Developer Contact ‚ñæ", contactTitle: "Contact Info",
      copy: "Copy", copied: "Copied!", uploadTitle: "File Upload",
      uploadSub: "Choose files and get an instant share link", dropText: "Drag & Drop files here",
      chooseBtn: "Choose files", uploadBtn: "Upload", maxSize: "Max file size",
      whyTitle: "Why Filesb", why1: "No messengers needed", why2: "Minimalistic interface", why3: "Instant file links",
      advTitle: "Advanced Protection", adv1: "Modern file encryption", adv2: "Short server storage time",
      protectBtn: "Go to protection", status: "Status", loading: "Loading...",
      completed: "Completed!", error: "Error occurred", errTitle: "Operation Failed",
      defaultError: "An unexpected error occurred."
    },
    ru: {
      langBtn: "–Ø–∑—ã–∫: RU ‚ñæ", contactBtn: "–°–≤—è–∑—å —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º ‚ñæ", contactTitle: "–ö–æ–Ω—Ç–∞–∫—Ç—ã",
      copy: "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å", copied: "–ì–æ—Ç–æ–≤–æ!", uploadTitle: "–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤",
      uploadSub: "–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª—ã –∏ –ø–æ–ª—É—á–∏—Ç–µ –º–≥–Ω–æ–≤–µ–Ω–Ω—É—é —Å—Å—ã–ª–∫—É", dropText: "–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞",
      chooseBtn: "–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª—ã", uploadBtn: "–ó–∞–≥—Ä—É–∑–∏—Ç—å", maxSize: "–ú–∞–∫—Å. —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞",
      whyTitle: "–ü–æ—á–µ–º—É Filesb", why1: "–ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã –Ω–µ –Ω—É–∂–Ω—ã", why2: "–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å", why3: "–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏",
      advTitle: "–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∑–∞—â–∏—Ç–∞", adv1: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ", adv2: "–ö–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è",
      protectBtn: "–ü–µ—Ä–µ–π—Ç–∏ –∫ –∑–∞—â–∏—Ç–µ", status: "Status", loading: "–ó–∞–≥—Ä—É–∑–∫–∞...",
      completed: "–ó–∞–≤–µ—Ä—à–µ–Ω–æ!", error: "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞", errTitle: "–û—à–∏–±–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏",
      defaultError: "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –Ω–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞."
    }
  };

  // –°–ª–æ–≤–∞—Ä—å –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ –æ—à–∏–±–æ–∫ —Å —Å–µ—Ä–≤–µ—Ä–∞
  const serverErrorMap = {
    "file too large": { en: "The file is too large.", ru: "–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π." },
    "invalid format": { en: "This file format is not supported.", ru: "–§–æ—Ä–º–∞—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è." },
    "server busy": { en: "Server is busy, try again later.", ru: "–°–µ—Ä–≤–µ—Ä –∑–∞–Ω—è—Ç." },
    "empty file": { en: "Cannot upload empty files.", ru: "–§–∞–π–ª –ø—É—Å—Ç–æ–π." }
  };

  let currentLang = localStorage.getItem('userLanguage') || 'en';

  function setLanguage(lang) {
    currentLang = lang;
    localStorage.setItem('userLanguage', lang);
    document.documentElement.lang = lang;
    document.querySelectorAll('[data-i18n]').forEach(el => {
      const key = el.getAttribute('data-i18n');
      if(translations[lang][key]) el.textContent = translations[lang][key];
    });
    document.getElementById('langBtn').textContent = translations[lang].langBtn;
    document.getElementById('devContactBtn').textContent = translations[lang].contactBtn;
    document.querySelectorAll('.lang-item').forEach(item => {
      item.classList.toggle('active', item.getAttribute('data-lang') === lang);
    });
    document.getElementById('langDropdown').classList.remove('show');
  }
  document.addEventListener('DOMContentLoaded', () => setLanguage(currentLang));

  // --- UI –õ–û–ì–ò–ö–ê ---
  const devContactBtn = document.getElementById('devContactBtn');
  const devDropdown = document.getElementById('devDropdown');
  const langBtn = document.getElementById('langBtn');
  const langDropdown = document.getElementById('langDropdown');

  devContactBtn.onclick = (e) => { e.stopPropagation(); devDropdown.classList.toggle('show'); langDropdown.classList.remove('show'); };
  langBtn.onclick = (e) => { e.stopPropagation(); langDropdown.classList.toggle('show'); devDropdown.classList.remove('show'); };
  window.onclick = () => { devDropdown.classList.remove('show'); langDropdown.classList.remove('show'); };

  async function copyValue(text, el) {
    try {
      await navigator.clipboard.writeText(text);
      const status = el.querySelector('.copy-status');
      status.textContent = translations[currentLang].copied;
      setTimeout(() => { status.textContent = translations[currentLang].copy; }, 1500);
    } catch (err) {}
  }

  // --- –ó–ê–ì–†–£–ó–ö–ê –§–ê–ô–õ–û–í ---
  const fileInput = document.getElementById('fileInput');
  const uploadBtn = document.getElementById('uploadBtn');
  const chooseBtn = document.getElementById('chooseBtn');
  const dropzone = document.getElementById('dropzone');
  const overlay = document.getElementById('overlay');
  const terminalText = document.getElementById('terminalText');
  const fileList = document.getElementById('fileList');
  const protectBtn = document.getElementById('protectBtn');
  const errorBox = document.getElementById('errorBox');
  const errorMessage = document.getElementById('errorMessage');

  let selectedFiles = [];
  protectBtn.onclick = () => { window.location.href = '/protect'; };
  chooseBtn.onclick = () => fileInput.click();

  function renderList() {
    fileList.innerHTML = '';
    selectedFiles.forEach(f => {
      const div = document.createElement('div');
      div.textContent = `‚Ä¢ ${f.name}`;
      fileList.appendChild(div);
    });
    uploadBtn.disabled = selectedFiles.length === 0;
    hideError();
  }

  fileInput.onchange = (e) => { selectedFiles = [...e.target.files]; renderList(); };

  ['dragenter','dragover'].forEach(ev => {
    dropzone.addEventListener(ev, e => { e.preventDefault(); dropzone.classList.add('dragover'); });
  });
  ['dragleave','drop'].forEach(ev => {
    dropzone.addEventListener(ev, e => { e.preventDefault(); dropzone.classList.remove('dragover'); });
  });
  dropzone.addEventListener('drop', e => {
    e.preventDefault();
    selectedFiles = Array.from(e.dataTransfer.files);
    renderList();
  });

  function showError(msg) {
    errorMessage.textContent = msg;
    errorBox.classList.add('visible');
  }
  function hideError() {
    errorBox.classList.remove('visible');
  }
  function translateServerError(serverMsg) {
    if (!serverMsg) return translations[currentLang].defaultError;
    const lowerMsg = serverMsg.toLowerCase();
    for (const key in serverErrorMap) {
      if (lowerMsg.includes(key)) return serverErrorMap[key][currentLang];
    }
    return serverMsg;
  }

  // === –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ó–ê–ì–†–£–ó–ö–ò ===
  uploadBtn.onclick = async () => {
    hideError();
    overlay.classList.add('show');
    terminalText.textContent = translations[currentLang].loading;
    terminalText.style.color = '#0f0';

    const fd = new FormData();
    selectedFiles.forEach(f => fd.append('file', f));

    try {
      const response = await fetch('/downloader/api', { method: 'POST', body: fd });
      const data = await response.json().catch(() => ({}));

      if (response.status === 401) {
        if (data.UrlToRedict) window.location.href = data.UrlToRedict;
        else window.location.href = "/login";
        return;
      }

      if (response.status === 400) {
        overlay.classList.remove('show');
        const translated = translateServerError(data.Error);
        showError(translated);
        return;
      }

      if (response.status === 200) {
        terminalText.textContent = translations[currentLang].completed;
        setTimeout(() => {
          if (data.UrlToRedict) window.location.href = data.UrlToRedict;
          else overlay.classList.remove('show');
        }, 1000);
        return;
      }
      throw new Error(`Server status: ${response.status}`);
    } catch (err) {
      overlay.classList.remove('show');
      showError(translations[currentLang].defaultError + " (" + err.message + ")");
    }
  };
</script>

</body>
</html>